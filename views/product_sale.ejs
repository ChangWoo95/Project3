<!DOCTYPE html>
<% if(session.auth != 's'){ %>
   <script>alert('접근권한이 없습니다.');location.href='/mall/';</script>
<% } %>
<html lang="en">
<head>
   <title>Product_sale</title>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1">
<!--===============================================================================================-->   
   <link rel="icon" type="image/png" href="images/icons/favicon.png"/>
<!--===============================================================================================-->
   <link rel="stylesheet" type="text/css" href="vendor/bootstrap/css/bootstrap.min.css">
<!--===============================================================================================-->
   <link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.7.0/css/font-awesome.min.css">
<!--===============================================================================================-->
   <link rel="stylesheet" type="text/css" href="fonts/iconic/css/material-design-iconic-font.min.css">
<!--===============================================================================================-->
   <link rel="stylesheet" type="text/css" href="fonts/linearicons-v1.0.0/icon-font.min.css">
<!--===============================================================================================-->
   <link rel="stylesheet" type="text/css" href="vendor/animate/animate.css">
<!--===============================================================================================-->   
   <link rel="stylesheet" type="text/css" href="vendor/css-hamburgers/hamburgers.min.css">
<!--===============================================================================================-->
   <link rel="stylesheet" type="text/css" href="vendor/animsition/css/animsition.min.css">
<!--===============================================================================================-->
   <link rel="stylesheet" type="text/css" href="vendor/select2/select2.min.css">
<!--===============================================================================================-->   
   <link rel="stylesheet" type="text/css" href="vendor/daterangepicker/daterangepicker.css">
<!--===============================================================================================-->
   <link rel="stylesheet" type="text/css" href="vendor/slick/slick.css">
<!--===============================================================================================-->
   <link rel="stylesheet" type="text/css" href="vendor/MagnificPopup/magnific-popup.css">
<!--===============================================================================================-->
   <link rel="stylesheet" type="text/css" href="vendor/perfect-scrollbar/perfect-scrollbar.css">
<!--===============================================================================================-->
   <link rel="stylesheet" type="text/css" href="css/util.css">
   <link rel="stylesheet" type="text/css" href="css/main.css">
<!--===============================================================================================-->
<style> 
   #m_data{ border-top-left-radius: 5px; border-bottom-left-radius: 5px; margin-right:-4px; 
         border-top-right-radius: 5px; border-bottom-right-radius: 5px;}
   #d_data{ border-top-left-radius: 5px; border-bottom-left-radius: 5px; margin-right:-4px; 
         border-top-right-radius: 5px; border-bottom-right-radius: 5px;}
   #h_data{ border-top-left-radius: 5px; border-bottom-left-radius: 5px; margin-right:-4px; 
         border-top-right-radius: 5px; border-bottom-right-radius: 5px;}                    
   #btn_g button{ border: 1px solid skyblue; background-color: rgba(0,0,0,0); color: skyblue; padding: 5px; }
   #btn_g button:hover{ color:white; background-color: skyblue; } 
</style>
</head>

<body class="animsition">
   
   <!-- Header -->
   <header class="header-v4">
      <!-- Header desktop -->
      <div class="container-menu-desktop">
         <!-- Topbar -->
         <div class="top-bar">
            <div class="content-topbar flex-sb-m h-full container">
               <div class="left-top-bar">
                  <% if(session.islogined){ %>
                     <h2><%= session.name %>님 안녕하세요!</h2>
                  <% } %>
               </div>

               <div class="right-top-bar flex-w h-full">
                  <a href="/mall/logout" class="flex-c-m trans-04 p-lr-25">
                     Logout
                  </a>

                  <a href="/mall/myaccount" class="flex-c-m trans-04 p-lr-25">
                     My Account
                  </a>
               </div>
            </div>
         </div>

         <div class="wrap-menu-desktop how-shadow1">
            <nav class="limiter-menu-desktop container">
               
               <!-- Logo desktop -->      
               <a href="/mall" class="logo">
                  <img src="images/icons/logo-01.png" alt="IMG-LOGO">
               </a>

               <!-- Menu desktop -->
               <div class="menu-desktop">
                  <ul class="main-menu">
                     <li><a href="/mall/product_manage">상품관리</a>
                     </li>
                     <li><a href="/mall/product_orderlist">주문현황</a>
                     </li>                     
                     <li class="active-menu">
                        <a href="/mall/product_sale">판매조회</a>
                     </li>
                  </ul>
               </div>   

            </nav>
         </div>   
      </div>

      <!-- Header Mobile -->
      <div class="wrap-header-mobile">
         <!-- Logo moblie -->      
         <div class="logo-mobile">
            <a href="/mall/"><img src="images/icons/logo-01.png" alt="IMG-LOGO"></a>
         </div>

         <!-- Button show menu -->
         <div class="btn-show-menu-mobile hamburger hamburger--squeeze">
            <span class="hamburger-box">
               <span class="hamburger-inner"></span>
            </span>
         </div>
      </div>


      <!-- Menu Mobile -->
      <div class="menu-mobile">
         <ul class="topbar-mobile">
            <li>
                  <% if(session.islogined){ %>
                     <h2><%= session.name %>님 안녕하세요!</h2>
                  <% } %>
            </li>

            <li>
               <div class="right-top-bar flex-w h-full">
            <% if(session.islogined){ %>
            <a href="/mall/logout" class="flex-c-m trans-04 p-lr-25">
               Logout
            </a>
            <a href="/mall/myaccount" class="flex-c-m p-lr-10 trans-04">
               My Account
            </a>
            <% } %>
               </div>
            </li>
         </ul>

         <ul class="main-menu-m">
            <li>
               <a href="/mall">Home</a>
            </li>
            <li><a href="/mall/product_manage">상품관리</a></li>
            <li><a href="/mall/product_orderlist">주문현황</a></li>
            <li><a href="/mall/product_sale">판매조회</a></li>
         </ul>
      </div>

      <!-- Modal Search -->
      <div class="modal-search-header flex-c-m trans-04 js-hide-modal-search">
         <div class="container-search-header">
            <button class="flex-c-m btn-hide-modal-search trans-04 js-hide-modal-search">
               <img src="images/icons/icon-close2.png" alt="CLOSE">
            </button>

            <form class="wrap-search-header flex-w p-l-15">
               <button class="flex-c-m trans-04">
                  <i class="zmdi zmdi-search"></i>
               </button>
               <input class="plh3" type="text" name="search" placeholder="Search...">
            </form>
         </div>
      </div>
   </header>

   <!-- Cart -->
   <div class="wrap-header-cart js-panel-cart">
      <div class="s-full js-hide-cart"></div>

      <div class="header-cart flex-col-l p-l-65 p-r-25">
         <div class="header-cart-title flex-w flex-sb-m p-b-8">
            <span class="mtext-103 cl2">
               Your Cart
            </span>

            <div class="fs-35 lh-10 cl2 p-lr-5 pointer hov-cl1 trans-04 js-hide-cart">
               <i class="zmdi zmdi-close"></i>
            </div>
         </div>
         
         <div class="header-cart-content flex-w js-pscroll">
            <ul class="header-cart-wrapitem w-full">
               <li class="header-cart-item flex-w flex-t m-b-12">
                  <div class="header-cart-item-img">
                     <img src="images/item-cart-01.jpg" alt="IMG">
                  </div>

                  <div class="header-cart-item-txt p-t-8">
                     <a href="#" class="header-cart-item-name m-b-18 hov-cl1 trans-04">
                        White Shirt Pleat
                     </a>

                     <span class="header-cart-item-info">
                        1 x $19.00
                     </span>
                  </div>
               </li>

               <li class="header-cart-item flex-w flex-t m-b-12">
                  <div class="header-cart-item-img">
                     <img src="images/item-cart-02.jpg" alt="IMG">
                  </div>

                  <div class="header-cart-item-txt p-t-8">
                     <a href="#" class="header-cart-item-name m-b-18 hov-cl1 trans-04">
                        Converse All Star
                     </a>

                     <span class="header-cart-item-info">
                        1 x $39.00
                     </span>
                  </div>
               </li>

               <li class="header-cart-item flex-w flex-t m-b-12">
                  <div class="header-cart-item-img">
                     <img src="images/item-cart-03.jpg" alt="IMG">
                  </div>

                  <div class="header-cart-item-txt p-t-8">
                     <a href="#" class="header-cart-item-name m-b-18 hov-cl1 trans-04">
                        Nixon Porter Leather
                     </a>

                     <span class="header-cart-item-info">
                        1 x $17.00
                     </span>
                  </div>
               </li>
            </ul>
            
            <div class="w-full">
               <div class="header-cart-total w-full p-tb-40">
                  Total: $75.00
               </div>

               <div class="header-cart-buttons flex-w w-full">
                  <a href="/mall/cart" class="flex-c-m stext-101 cl0 size-107 bg3 bor2 hov-btn3 p-lr-15 trans-04 m-r-8 m-b-10">
                     View Cart
                  </a>

                  <a href="/mall/check_out" class="flex-c-m stext-101 cl0 size-107 bg3 bor2 hov-btn3 p-lr-15 trans-04 m-b-10">
                     Check Out
                  </a>
               </div>
            </div>
         </div>
      </div>
   </div>


<script>
   var mon_label = ["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"];
   var mon_data = [0,0,0,0,0,0,0,0,0,0,0,0];
   var mon_label2 = ["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"];
   var mon_data2 = [0,0,0,0,0,0,0,0,0,0,0,0];
   var daily_label = ["1일","2일","3일","4일","5일","6일","7일","8일","9일","10일","11일","12일","13일","14일","15일","16일","17일","18일","19일","20일","21일","22일","23일","24일","25일","26일","27일","28일","29일","30일","31일"];
   var daily_data = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
   var hour_label = ["00h","01h","02h","03h","04h","05h","06h","07h","08h","09h","10h","11h","12h","13h","14h","15h","16h","17h","18h","19h","20h","21h","22h","23h","24h"];
   var hour_data = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];

   var mon_bc = [];
   var mon_bb = [];
   var mon_bc2 = [];
   var mon_bb2 = [];   
   for(var i=0;i<12;i++){
      var x = Math.floor(Math.random() * 256);
      var y = Math.floor(Math.random() * 256);
      var z = Math.floor(Math.random() * 256);
      var b_c = "rgba(" + x + "," + y + "," + z + "," + "0.2)";
      var b_b = "rgba(" + x + "," + y + "," + z + "," + "1)";
      mon_bc.push(b_c);
      mon_bb.push(b_b);       
      mon_bc2.push(b_c);
      mon_bb2.push(b_b);      
   }
   var daily_bc = [];
   var daily_bb = [];
   for(var i=0;i<31;i++){
      var x = Math.floor(Math.random() * 256);
      var y = Math.floor(Math.random() * 256);
      var z = Math.floor(Math.random() * 256);
      var b_c = "rgba(" + x + "," + y + "," + z + "," + "0.2)";
      var b_b = "rgba(" + x + "," + y + "," + z + "," + "1)";
      daily_bc.push(b_c);
      daily_bb.push(b_b);            
   }   
   var hour_bc = [];
   var hour_bb = [];
   for(var i=0;i<24;i++){
      var x = Math.floor(Math.random() * 256);
      var y = Math.floor(Math.random() * 256);
      var z = Math.floor(Math.random() * 256);
      var b_c = "rgba(" + x + "," + y + "," + z + "," + "0.2)";
      var b_b = "rgba(" + x + "," + y + "," + z + "," + "1)";
      hour_bc.push(b_c);
      hour_bb.push(b_b);            
   } 

   function ch_val(str,cnt,sale){
      if(str == "mon") {
         mon_data[cnt-1] = sale;
         mon_data2[cnt-1] = sale;
      }
      else if(str == "day") daily_data[cnt-1] = sale;
      else hour_data[cnt-1] = sale;
   }

   function numberWithCommas(x) {
      document.write( x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") +"원" );
   }

</script>

<%for(var i=0; i< g_mon.length; i++){%>
   <script>ch_val("mon",<%=g_mon[i].mon%>,<%=g_mon[i].sale%>);</script>
<% } %>
<%for(var i=0; i< g_day.length; i++){%>
   <script>ch_val("day",<%=g_day[i].day%>,<%=g_day[i].sale%>);</script>
<% } %>
<%for(var i=0; i< g_hour.length; i++){%>
   <script>ch_val("hour",<%=g_hour[i].hour%>,<%=g_hour[i].sale%>);</script>
<% } %>

<!--차트 뿌리기-->
   <br><br>
 <div class="col-lg-6 col-xl-6 m-lr-auto m-b-50"> 
   <div id="btn_g">
      <button type="button" id="m_data">월 별</button>
      <button type="button" id="d_data">일 별 </button>
      <button type="button" id="h_data">시간 별</button>
   </div>
   <canvas id="myChart" width="400" height="400"></canvas>
</div>

   <form class="bg0 p-t-75 p-b-85">
   <center><H3>판매내역</H3></center><br><br>
      <div class="container">
      
         <div class="row">
            <div class="col-lg-10 col-xl-10 m-lr-auto m-b-50">
               <div class="m-l-25 m-r--38 m-lr-0-xl">
                  <div class="wrap-table-shopping-cart">
                     <table class="table-shopping-cart">
                        <tr class="table_head">
                           <th class="column-1">사진</th>
                           <th class="column-3">이름</th>
                           <th class="column-3">가격</th>
                           <th class="column-4">type</th>
                           <th class="column-5">category</th>
                           <th class="column-6">brand</th>
                           <th class="column-4">order-date</th>
                           <th class="column-5">판매수량</th>
                        </tr>
                        <% if(rows.length == 0) {%>
                           <tr class="table_row">
                              <td colspan="8"><div style="text-align:center">판매된 상품이 없습니다.</div></td>
                           </tr>                        
                        <%   }else {
                           for(var i = 0; i< rows.length; i++){
                           var oneUser = rows[i];
                        %>
                        <tr class="table_row">
                           <td><img src="images/<%=oneUser.img%>" alt="사진 없음" width="150" height="150"/></td>
                           <td class="column-3"><%=oneUser.name%></td>
                           <td class="column-3"><script>numberWithCommas(<%=oneUser.price%>);</script></td>
                           <td class="column-4"><%=oneUser.type%></td>
                           <td class="column-5"><%=oneUser.category%></td>
                           <td class="column-6"><%=oneUser.brand%></td>
                           <td class="column-4"><%=oneUser.date%></td>
                           <td class="column-5"><%=oneUser.cnt%></td>
                        </tr>
                        <%
                              }
                           }
                        %>
                     </table>
                  </div>

               </div>
            </div>
         </div>
      </div>
   </form>

      

   <!-- Footer -->
   <footer class="bg3 p-t-75 p-b-32">
      <div class="container"></div>

         <div class="p-t-40">
            <div class="flex-c-m flex-w p-b-18">
               <a href="#" class="m-all-1">
                  <img src="images/icons/icon-pay-01.png" alt="ICON-PAY">
               </a>

               <a href="#" class="m-all-1">
                  <img src="images/icons/icon-pay-02.png" alt="ICON-PAY">
               </a>

               <a href="#" class="m-all-1">
                  <img src="images/icons/icon-pay-03.png" alt="ICON-PAY">
               </a>

               <a href="#" class="m-all-1">
                  <img src="images/icons/icon-pay-04.png" alt="ICON-PAY">
               </a>

               <a href="#" class="m-all-1">
                  <img src="images/icons/icon-pay-05.png" alt="ICON-PAY">
               </a>
            </div>

            <p class="stext-107 cl6 txt-center">
               <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with 정창우, 윤상욱, 김효주, 이원형
<!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->

            </p>
         </div>
      </div>
   </footer>


   <!-- Back to top -->
   <div class="btn-back-to-top" id="myBtn">
      <span class="symbol-btn-back-to-top">
         <i class="zmdi zmdi-chevron-up"></i>
      </span>
   </div>

<!--------------------------------------------차트------------------------------------------------------->
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.js"></script>
<script src="js/sale_chart.js"></script>

<!--===============================================================================================-->   
   <script src="vendor/jquery/jquery-3.2.1.min.js"></script>
<!--===============================================================================================-->
   <script src="vendor/animsition/js/animsition.min.js"></script>
<!--===============================================================================================-->
   <script src="vendor/bootstrap/js/popper.js"></script>
   <script src="vendor/bootstrap/js/bootstrap.min.js"></script>
<!--===============================================================================================-->
   <script src="vendor/select2/select2.min.js"></script>
   <script>
      $(".js-select2").each(function(){
         $(this).select2({
            minimumResultsForSearch: 20,
            dropdownParent: $(this).next('.dropDownSelect2')
         });
      })
   </script>
<!--===============================================================================================-->
   <script src="vendor/MagnificPopup/jquery.magnific-popup.min.js"></script>
<!--===============================================================================================-->
   <script src="vendor/perfect-scrollbar/perfect-scrollbar.min.js"></script>
   <script>
      $('.js-pscroll').each(function(){
         $(this).css('position','relative');
         $(this).css('overflow','hidden');
         var ps = new PerfectScrollbar(this, {
            wheelSpeed: 1,
            scrollingThreshold: 1000,
            wheelPropagation: false,
         });

         $(window).on('resize', function(){
            ps.update();
         })
      });
   </script>
<!--===============================================================================================-->
   <script src="js/main.js"></script>

</body>
</html>